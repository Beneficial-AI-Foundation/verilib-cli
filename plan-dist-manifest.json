{"diagnostic": {"message": "/Users/nimahamed/Documents/projects/verilib-cli/.github/workflows/release.yml has out of date contents and needs to be regenerated:\n--- /Users/nimahamed/Documents/projects/verilib-cli/.github/workflows/release.yml\n+++ /Users/nimahamed/Documents/projects/verilib-cli/.github/workflows/release.yml\n@@ -43,12 +43,6 @@\n   push:\n     tags:\n       - '**[0-9]+.[0-9]+.[0-9]+*'\n-  workflow_dispatch:\n-    inputs:\n-      tag:\n-        description: 'Release tag (e.g., v0.1.2)'\n-        required: true\n-        type: string\n \n jobs:\n   # Run 'dist plan' (or host) to determine what tasks we need to do\n@@ -56,38 +50,16 @@\n     runs-on: \"ubuntu-22.04\"\n     outputs:\n       val: ${{ steps.plan.outputs.manifest }}\n-      tag: ${{ github.event.inputs.tag || (!github.event.pull_request && github.ref_name) || '' }}\n-      tag-flag: ${{ github.event.inputs.tag && format('--tag={0}', github.event.inputs.tag) || (!github.event.pull_request && format('--tag={0}', github.ref_name)) || '' }}\n-      publishing: ${{ github.event.inputs.tag != '' || (!github.event.pull_request && github.ref_type == 'tag') }}\n+      tag: ${{ !github.event.pull_request && github.ref_name || '' }}\n+      tag-flag: ${{ !github.event.pull_request && format('--tag={0}', github.ref_name) || '' }}\n+      publishing: ${{ !github.event.pull_request }}\n     env:\n       GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n     steps:\n       - uses: actions/checkout@v4\n         with:\n-          persist-credentials: ${{ github.event.inputs.tag != '' }}\n-          token: ${{ github.event.inputs.tag != '' && secrets.GITHUB_TOKEN || '' }}\n+          persist-credentials: false\n           submodules: recursive\n-      - name: Verify version consistency\n-        if: ${{ github.event.inputs.tag != '' }}\n-        run: |\n-          CARGO_VERSION=$(grep \"^version\" Cargo.toml | sed 's/version = \"\\(.*\\)\"/\\1/')\n-          TAG_VERSION=\"${{ github.event.inputs.tag }}\"\n-          # Remove 'v' prefix if present\n-          TAG_VERSION_CLEAN=$(echo \"$TAG_VERSION\" | sed 's/^v//')\n-          \n-          echo \"Cargo.toml version: $CARGO_VERSION\"\n-          echo \"Tag version (clean): $TAG_VERSION_CLEAN\"\n-          \n-          if [ \"$CARGO_VERSION\" != \"$TAG_VERSION_CLEAN\" ]; then\n-            echo \"⚠️  Version mismatch!\"\n-            echo \"Cargo.toml has version $CARGO_VERSION but tag is $TAG_VERSION\"\n-            echo \"You may need to:\"\n-            echo \"1. Update Cargo.toml to version $TAG_VERSION_CLEAN, or\"\n-            echo \"2. Use tag v$CARGO_VERSION instead\"\n-            exit 1\n-          else\n-            echo \"✅ Version matches between Cargo.toml and tag\"\n-          fi\n       - name: Install dist\n         # we specify bash to get pipefail; it guards against the `curl` command\n         # failing. otherwise `sh` won't catch that `curl` returned non-0\n@@ -105,25 +77,7 @@\n       # but also really annoying to build CI around when it needs secrets to work right.)\n       - id: plan\n         run: |\n-          echo \"Event name: ${{ github.event_name }}\"\n-          echo \"Ref type: ${{ github.ref_type }}\"\n-          echo \"Ref name: ${{ github.ref_name }}\"\n-          echo \"Manual tag input: ${{ github.event.inputs.tag }}\"\n-          echo \"Current Cargo.toml version:\"\n-          grep \"^version\" Cargo.toml || echo \"No version found in Cargo.toml\"\n-          echo \"Existing tags:\"\n-          git tag -l | head -10 || echo \"No tags found\"\n-          \n-          if [ -n \"${{ github.event.inputs.tag }}\" ]; then\n-            echo \"Manual workflow dispatch with tag: ${{ github.event.inputs.tag }}\"\n-            dist host --steps=create --tag=\"${{ github.event.inputs.tag }}\" --output-format=json > plan-dist-manifest.json\n-          elif [ \"${{ github.event_name }}\" = \"push\" ] && [ \"${{ github.ref_type }}\" = \"tag\" ]; then\n-            echo \"Automatic tag push with tag: ${{ github.ref_name }}\"\n-            dist host --steps=create --tag=\"${{ github.ref_name }}\" --output-format=json > plan-dist-manifest.json\n-          else\n-            echo \"Pull request or other event - using plan mode\"\n-            dist plan --output-format=json > plan-dist-manifest.json\n-          fi\n+          dist ${{ (!github.event.pull_request && format('host --steps=create --tag={0}', github.ref_name)) || 'plan' }} --output-format=json > plan-dist-manifest.json\n           echo \"dist ran successfully\"\n           cat plan-dist-manifest.json\n           echo \"manifest=$(jq -c \".\" plan-dist-manifest.json)\" >> \"$GITHUB_OUTPUT\"\n@@ -158,8 +112,6 @@\n     env:\n       GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n       BUILD_MANIFEST_NAME: target/distrib/${{ join(matrix.targets, '-') }}-dist-manifest.json\n-      PKG_CONFIG_ALLOW_CROSS: 1\n-      OPENSSL_NO_VENDOR: 1\n     steps:\n       - name: enable windows longpaths\n         run: |\n@@ -174,14 +126,6 @@\n           if ! command -v cargo > /dev/null 2>&1; then\n             curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y\n             echo \"$HOME/.cargo/bin\" >> $GITHUB_PATH\n-            # Source the cargo environment\n-            source \"$HOME/.cargo/env\"\n-          fi\n-          # Ensure we have the target for cross-compilation if needed\n-          if [ -n \"${{ matrix.targets }}\" ]; then\n-            for target in ${{ join(matrix.targets, ' ') }}; do\n-              rustup target add \"$target\" || true\n-            done\n           fi\n       - name: Install dist\n         run: ${{ matrix.install_dist.run }}\n@@ -195,20 +139,6 @@\n       - name: Install dependencies\n         run: |\n           ${{ matrix.packages_install }}\n-      - name: Configure environment for cross-compilation\n-        shell: bash\n-        run: |\n-          # Set environment variables to avoid pkg-config cross-compilation issues\n-          echo \"PKG_CONFIG_ALLOW_CROSS=1\" >> $GITHUB_ENV\n-          echo \"OPENSSL_NO_VENDOR=1\" >> $GITHUB_ENV\n-          # Force use of rustls instead of OpenSSL\n-          echo \"CARGO_NET_GIT_FETCH_WITH_CLI=true\" >> $GITHUB_ENV\n-          # Verify that we're using rustls-tls in Cargo.toml\n-          if grep -q 'features.*rustls-tls' Cargo.toml; then\n-            echo \"✓ Using rustls-tls - no system OpenSSL required\"\n-          else\n-            echo \"⚠ Warning: rustls-tls not found in Cargo.toml\"\n-          fi\n       - name: Build artifacts\n         run: |\n           # Actually do builds and make zips and whatnot\n","severity": "error","causes": [],"help": "run 'dist init' to update the file\n('allow-dirty' in Cargo.toml to ignore out of date contents)","labels": [],"related": []}}
